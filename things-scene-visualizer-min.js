!function(e){function t(n){if(r[n])return r[n].exports;var o=r[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var r={};t.m=e,t.c=r,t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=1)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i={A:"black",B:"#ccaa76",C:"#ff1100",D:"#252525",E:"#6ac428"},a=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return r._model=e,r.createObject(e),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,THREE.Mesh),o(t,[{key:"createObject",value:function(e){this.createStock(e.width,e.height,e.depth)}},{key:"createStock",value:function(e,r,n){this.model.fillStyle;this.geometry=new THREE.BoxBufferGeometry(e,n,r),this.material=t.getMaterial("B"),this.type="stock"}},{key:"onUserDataChanged",value:function(){(function e(t,r,n){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,r);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,r,n)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(n)})(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"onUserDataChanged",this).call(this),this.material=t.getMaterial(this.userData.GUBUN||this.userData.gubun),"A"==(this.userData.GUBUN||this.userData.gubun)?this.visible=!1:this.visible=!0}},{key:"onmousemove",value:function(e,t){var r=t.tooltip||t._scene2d.getObjectByName("tooltip");if(r&&(t._scene2d.remove(r),t.tooltip=null,t.render_threed()),this.visible){this.userData||(this.userData={});var o="";for(var i in this.userData)/^__/.test(i)||this.userData[i]&&"object"!=n(this.userData[i])&&(o+=i+": "+this.userData[i]+"\n");if(o.length>0){r=t.tooltip=t.makeTextSprite(o);var a=new THREE.Vector3,s=new THREE.Vector3;a.set(t._mouse.x,t._mouse.y,.5),s.set(100,50,0),a.unproject(t._2dCamera),a.add(s),r.position.set(a.x,a.y,a.z),r.name="tooltip",t._scene2d.add(r),t._renderer&&t._renderer.render(t._scene2d,t._2dCamera),t.invalidate()}}}},{key:"model",get:function(){return this._model}}],[{key:"getMaterial",value:function(e){var r;switch(e){default:case"A":r=t.blackMaterial;break;case"B":r=t.brownMaterial;break;case"C":r=t.redMaterial;break;case"D":r=t.darkMaterial;break;case"E":r=t.greenMaterial}return r}},{key:"blackMaterial",get:function(){return t._material_black||(t._material_black=new THREE.MeshLambertMaterial({color:i.A,side:THREE.FrontSide})),t._material_black}},{key:"brownMaterial",get:function(){return t._material_brown||(t._material_brown=new THREE.MeshLambertMaterial({color:i.B,side:THREE.FrontSide})),t._material_brown}},{key:"redMaterial",get:function(){return t._material_red||(t._material_red=new THREE.MeshLambertMaterial({color:i.C,side:THREE.FrontSide})),t._material_red}},{key:"darkMaterial",get:function(){return t._material_dark||(t._material_dark=new THREE.MeshLambertMaterial({color:i.D,side:THREE.FrontSide})),t._material_dark}},{key:"greenMaterial",get:function(){return t._material_green||(t._material_green=new THREE.MeshLambertMaterial({color:i.E,side:THREE.FrontSide})),t._material_green}}]),t}();t.default=a},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=r(2);Object.defineProperty(t,"default",{enumerable:!0,get:function(){return n(o).default}});var i=r(3);Object.defineProperty(t,"Component3d",{enumerable:!0,get:function(){return n(i).default}});var a=r(4);Object.defineProperty(t,"Visualizer",{enumerable:!0,get:function(){return n(a).default}});var s=r(7);Object.defineProperty(t,"VideoPlayer360",{enumerable:!0,get:function(){return n(s).default}});var c=r(8);Object.defineProperty(t,"Door",{enumerable:!0,get:function(){return n(c).default}});var l=r(9);Object.defineProperty(t,"ForkLift",{enumerable:!0,get:function(){return n(l).default}});var u=r(10);Object.defineProperty(t,"HumiditySensor",{enumerable:!0,get:function(){return n(u).default}});var h=r(11);Object.defineProperty(t,"Person",{enumerable:!0,get:function(){return n(h).default}});var f=r(12);Object.defineProperty(t,"Plane",{enumerable:!0,get:function(){return n(f).default}});var d=r(13);Object.defineProperty(t,"Rack",{enumerable:!0,get:function(){return n(d).default}});var p=r(0);Object.defineProperty(t,"Stock",{enumerable:!0,get:function(){return n(p).default}});var y=r(14);Object.defineProperty(t,"Wall",{enumerable:!0,get:function(){return n(y).default}});var m=r(15);Object.defineProperty(t,"Cube",{enumerable:!0,get:function(){return n(m).default}});var b=r(16);Object.defineProperty(t,"Cylinder",{enumerable:!0,get:function(){return n(b).default}});var v=r(17);Object.defineProperty(t,"Sphere",{enumerable:!0,get:function(){return n(v).default}});var _=r(18);Object.defineProperty(t,"Cone",{enumerable:!0,get:function(){return n(_).default}});var E=r(19);Object.defineProperty(t,"Banner",{enumerable:!0,get:function(){return n(E).default}});var w=r(20);Object.defineProperty(t,"Desk",{enumerable:!0,get:function(){return n(w).default}});var g=r(21);Object.defineProperty(t,"Beacon3D",{enumerable:!0,get:function(){return n(g).default}})},function(e,t,r){"use strict";THREE&&THREE.Object3D&&(THREE.Object3D.prototype.onUserDataChanged=function(){if(this.userData){if(this.userData.hasOwnProperty("location")){if(!this._threeContainer)return;this._setPosition(this._threeContainer.transcoord2dTo3d(this.userData.location))}this.userData.hasOwnProperty("euler")&&this._setEuler({yaw:this.userData.euler.yaw,pitch:this.userData.euler.pitch,roll:this.userData.euler.roll}),this.userData.hasOwnProperty("quaternion")&&this._setQuaternion({x:this.userData.quaternion.qx,y:this.userData.quaternion.qy,z:this.userData.quaternion.qz,w:this.userData.quaternion.qw})}},THREE.Object3D.prototype._setPosition=function(e){var t=e.x,r=e.y,n=this._threeContainer.mixers.indexOf(this._mixer);n>=0&&this._threeContainer.mixers.splice(n,1),this._mixer=new THREE.AnimationMixer(this),this._threeContainer.mixers.push(this._mixer);var o=new THREE.VectorKeyframeTrack(".position",[0,1],[this.position.x,this.position.y,this.position.z,t,this.position.y,r]),i=new THREE.AnimationClip("Move",2,[o]),a=this._mixer.clipAction(i);a.clampWhenFinished=!0,a.loop=THREE.LoopOnce,a.play()},THREE.Object3D.prototype._setQuaternion=function(e){var t=e.x,r=e.y,n=e.z,o=e.w,i=new THREE.Quaternion;i.set(t,r,n,o),this.setRotationFromQuaternion(i),this.rotateOnAxis(new THREE.Vector3(1,0,0),-Math.PI),this.rotateOnAxis(new THREE.Vector3(0,1,0),Math.PI),this.rotateOnAxis(new THREE.Vector3(0,0,1),-Math.PI/2)},THREE.Object3D.prototype._setEuler=function(e){var t=e.yaw,r=e.pitch,n=e.roll,o=new THREE.Euler;o.set(t,r,n,"ZYX"),this.setRotationFromEuler(o)})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o={},i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return n(e,null,[{key:"register",value:function(e,t){if(!t)return o[e];o[e]=t}}]),e}();t.default=i,scene.Component3d=i},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(){o.done||(THREE.Loader.Handlers.add(/\.tga$/i,new THREE.TGALoader),o.done=!0)}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=function e(t,r,n){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,r);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,r,n)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(n)},s=(n(r(5)),n(r(6)));THREE.Cache.enabled=!0;var c=scene,l=c.Component,u=c.Container,h=c.Layout,f={mutable:!1,resizable:!0,rotatable:!0,properties:[{type:"number",label:"fov",name:"fov",property:"fov"},{type:"number",label:"near",name:"near",property:"near"},{type:"number",label:"far",name:"far",property:"far"},{type:"number",label:"zoom",name:"zoom",property:"zoom"},{type:"select",label:"precision",name:"precision",property:{options:["highp","mediump","lowp"]}},{type:"checkbox",label:"anti-alias",name:"antialias",property:"antialias"},{type:"checkbox",label:"auto-rotate",name:"autoRotate",property:"autoRotate"},{type:"checkbox",label:"show-axis",name:"showAxis",property:"showAxis"},{type:"checkbox",label:"3dmode",name:"threed",property:"threed"}]},d=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,u),i(t,[{key:"containable",value:function(e){return e.is3dish()}},{key:"putObject",value:function(e,t){this._objects||(this._objects={}),this._objects[e]=t}},{key:"getObject",value:function(e){return this._objects||(this._objects={}),this._objects[e]}},{key:"createFloor",value:function(e,t,r){var n,o=this.model.fillStyle,i=this;if("pattern"==o.type&&o.image){var a=this._textureLoader.load(this.app.url(o.image),function(e){e.minFilter=THREE.LinearFilter,i.render_threed()});n=new THREE.MeshBasicMaterial({map:a,side:THREE.DoubleSide})}else n=new THREE.MeshBasicMaterial({color:e,side:THREE.FrontSide});var s=new THREE.PlaneGeometry(t,r),c=new THREE.Mesh(s,n);c.rotation.x=-Math.PI/2,c.position.y=-2,c.name="floor",this._scene3d.add(c)}},{key:"createObjects",value:function(e,t){var r=e.filter(function(e){return"rack"==e.model.type}),n=new THREE.BoxBufferGeometry(1,1,1),o=new THREE.InstancedBufferGeometry;o.index=n.index,o.attributes.position=n.attributes.position,o.attributes.uv=n.attributes.uv;for(var i=[],a=[],s=[],c=0;c<r.length;c++){var l=this.transcoord3d(r[c].model),u=l.shelves;if(u)for(var h=0;h<u;h++){var f=JSON.parse(JSON.stringify(l));f.width*=.7,f.height*=.7,f.depth*=.7,f.y=h*l.height-(l.height-f.height)/2+f.y,a.push(f.x,f.y,f.z),i.push(f.width,f.height,f.depth),s.push(Math.random(),Math.random(),Math.random(),1)}}var d=new THREE.InstancedBufferAttribute(new Float32Array(a),3),p=new THREE.InstancedBufferAttribute(new Float32Array(i),3),y=new THREE.InstancedBufferAttribute(new Float32Array(s),4);o.addAttribute("offset",d),o.addAttribute("scale",p),o.addAttribute("color",y);var m=new THREE.RawShaderMaterial({uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.lights,{lightIntensity:{type:"f",value:1},textureSampler:{type:"t",value:null}}]),vertexShader:"\n      precision highp float;\n      uniform mat4 modelViewMatrix;\n      uniform mat4 projectionMatrix;\n      attribute vec3 scale;\n      attribute vec3 position;\n      attribute vec3 offset;\n      attribute vec2 uv;\n      attribute vec4 orientation;\n      attribute vec4 color;\n\n      varying vec2 vUv;\n      varying vec4 vColor;\n      void main() {\n        vec3 vPosition = position;\n        vec3 vScale = scale;\n        vUv = uv;\n\n        vColor = color;\n\n        gl_Position = projectionMatrix * modelViewMatrix * vec4( offset + vScale * vPosition, 1.0 );\n      }\n    ",fragmentShader:"\n      precision highp float;\n      uniform sampler2D map;\n      varying vec2 vUv;\n      varying vec3 vPosition;\n      varying vec4 vColor;\n\n      void main() {\n        vec4 color = vec4( vColor );\n        gl_FragColor = color;\n      }\n    ",transparent:!0}),b=new THREE.Mesh(o,m);this._scene3d.add(b)}},{key:"makeTextSprite",value:function(e,t){if(e){void 0===t&&(t={});var r=t.hasOwnProperty("fontFace")?t.fontFace:"Arial",n=t.hasOwnProperty("fontSize")?t.fontSize:32,o=t.hasOwnProperty("textColor")?t.textColor:"rgba(255,255,255,1)",i=t.hasOwnProperty("borderWidth")?t.borderWidth:2,a=t.hasOwnProperty("borderColor")?t.borderColor:"rgba(0, 0, 0, 1.0)",s=t.hasOwnProperty("backgroundColor")?t.backgroundColor:"rgba(0, 0, 0, 0.7)",c=t.hasOwnProperty("radius")?t.radius:30,l=t.hasOwnProperty("vAlign")?t.vAlign:"middle",u=t.hasOwnProperty("hAlign")?t.hAlign:"center",h=document.createElement("canvas"),f=h.getContext("2d");h.width=window.innerWidth,h.height=window.innerHeight,f.font=n+"px "+r,f.textBaseline="alphabetic",f.textAlign="left";var d=0,p=String(e).trim().split("\n"),y=h.width/2,m=h.height/2;for(var b in p){var v=f.measureText(p[b]);d<v.width&&(d=v.width)}var _=d/2;"bottom"==l?n:"top"==l&&0,"left"==u?_=d:"right"==u&&(_=0),this.roundRect(f,y-_,m-n*p.length*.5,d,n*p.length,c,i,a,s,5),f.fillStyle=o,f.lineWidth=3;var E=m-n*p.length*.5-5-i;for(var w in p)w=Number(w),E+=n,f.fillText(p[w],y-_,E);var g=new THREE.Texture(h);g.needsUpdate=!0;var T=new THREE.SpriteMaterial({map:g}),O=new THREE.Sprite(T);return O.scale.set(600,300,1),O.raycast=function(){},O}}},{key:"destroy_scene3d",value:function(){if(this.stop(),this._renderer&&this._renderer.clear(),this._renderer=void 0,this._camera=void 0,this._2dCamera=void 0,this._keyboard=void 0,this._controls=void 0,this._projector=void 0,this._load_manager=void 0,this._scene3d)for(var e in this._scene3d.children){var t=this._scene3d.children[e];t.dispose&&t.dispose(),t.geometry&&t.geometry.dispose(),t.material&&t.material.dispose(),t.texture&&t.texture.dispose(),this._scene3d.remove(t)}if(this._scene2d)for(var r in this._scene2d.children){var n=this._scene2d.children[r];n.dispose&&n.dispose(),n.geometry&&n.geometry.dispose(),n.material&&n.material.dispose(),n.texture&&n.texture.dispose(),this._scene2d.remove(n)}this._scene3d=void 0,this._scene2d=void 0}},{key:"init_scene3d",value:function(){this._scene3d&&this.destroy_scene3d(),o(),this._textureLoader=new THREE.TextureLoader,this._textureLoader.withCredential=!0,this._textureLoader.crossOrigin="use-credentials",this._exporter=new THREE.OBJExporter;var e=this.model,t=e.width,r=e.height,n=e.fov,i=void 0===n?45:n,a=e.near,c=void 0===a?.1:a,l=e.far,u=void 0===l?2e4:l,h=e.fillStyle,f=void 0===h?"#424b57":h,d=e.light,p=void 0===d?16777215:d,y=e.antialias,m=void 0===y||y,b=e.precision,v=void 0===b?"highp":b,_=this.components||[];this._scene3d=new THREE.Scene,this._scene2d=new THREE.Scene;var E=t/r;if(this._camera=new THREE.PerspectiveCamera(i,E,c,u),this._2dCamera=new THREE.OrthographicCamera(-t/2,t/2,r/2,-r/2,1,1e3),this._scene3d.add(this._camera),this._scene2d.add(this._2dCamera),this._camera.position.set(.8*r,.8*Math.max(t,r),.8*t),this._2dCamera.position.set(.8*r,.8*Math.max(t,r),.8*t),this._camera.lookAt(this._scene3d.position),this._2dCamera.lookAt(this._scene2d.position),this._camera.zoom=.01*this.model.zoom,this.model.showAxis){var w=new THREE.AxisHelper(t);this._scene3d.add(w)}try{this._renderer=new THREE.WebGLRenderer({precision:v,alpha:!0,antialias:m})}catch(e){this._noSupportWebgl=!0}if(!this._noSupportWebgl){this._renderer.autoClear=!1,this._renderer.setClearColor(16777215,0),this._renderer.setSize(t,r),this._controls=new s.default(this._camera,this);var g=new THREE.HemisphereLight(p,0,1);this._camera.add(g),this._raycaster=new THREE.Raycaster,this._mouse=new THREE.Vector2,this._tick=0,this._clock=new THREE.Clock(!0),this.mixers=new Array,this.createFloor(f,t,r),this.createObjects(_,{width:t,height:r}),this._load_manager=new THREE.LoadingManager,this._load_manager.onProgress=function(e,t,r){},this.threed_animate()}}},{key:"threed_animate",value:function(){this._animationFrame=requestAnimationFrame(this.threed_animate.bind(this)),this.update()}},{key:"stop",value:function(){cancelAnimationFrame(this._animationFrame)}},{key:"update",value:function(){this._controls.update(),this.render_threed()}},{key:"render_threed",value:function(){var e;this._clock&&(e=this._clock.getDelta());var t=this.mixers;for(var r in t)if(t.hasOwnProperty(r)){var n=t[r];n&&n.update(e)}this._renderer&&(this._renderer.clear(),this._renderer.render(this._scene3d,this._camera)),this._renderer&&this._scene2d&&this._renderer.render(this._scene2d,this._2dCamera),this.invalidate()}},{key:"_draw",value:function(e){this.app.isViewMode&&(this.model.threed||(this.model.threed=!0)),this.model.threed&&!this._noSupportWebgl||a(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_draw",this).call(this,e)}},{key:"_post_draw",value:function(e){var r=this.model,n=r.left,o=r.top,i=r.width,s=r.height;if(r.threed){if(this._scene3d||(this.init_scene3d(),this.render_threed()),this._noSupportWebgl)return void this._showWebglNoSupportText(e);this._dataChanged&&this._onDataChanged(),this.showTooltip(this._selectedPickingLocation),e.drawImage(this._renderer.domElement,0,0,i,s,n,o,i,s)}else a(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_post_draw",this).call(this,e)}},{key:"dispose",value:function(){a(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"dispose",this).call(this),this.destroy_scene3d()}},{key:"roundRect",value:function(e,t,r,n,o,i,a,s,c,l,u){if(void 0!=c||void 0!=s){var h=t-a-i-l,f=h+n+2*a+2*i+2*l,d=r-a-i-l,p=d+o+2*a+2*i+2*l;e.beginPath(),e.moveTo(h+i,d),e.lineTo(f-i,d),e.quadraticCurveTo(f,d,f,d+i),e.lineTo(f,p-i),e.quadraticCurveTo(f,p,f-i,p),e.lineTo(h+i,p),e.quadraticCurveTo(h,p,h,p-i),e.lineTo(h,d+i),e.quadraticCurveTo(h,d,h+i,d),e.closePath(),e.lineWidth=a,void 0!=c&&(e.fillStyle=c,e.fill()),a>0&&void 0!=s&&(e.strokeStyle=s,e.stroke())}}},{key:"getObjectByRaycast",value:function(){var e,t=this.getObjectsByRaycast();return t.length>0&&(e=t[0].object),e}},{key:"getObjectsByRaycast",value:function(){var e=this._mouse;if(this._camera){this._raycaster.setFromCamera(e,this._camera);return this._raycaster.intersectObjects(this._scene3d.children,!0)}}},{key:"moveCameraTo",value:function(e){if(e){var t=this._scene3d.getObjectByName(e,!0);if(t){var r=this,n=t.getWorldPosition();n.y=0;var o=n.distanceTo(new THREE.Vector3(0,0,0));n.multiplyScalar(1e3/(o||1));var r=this,i=this._camera.position.x-n.x,a=this._camera.position.y-300,s=this._camera.position.z-n.z;this.animate({step:function(e){var t=new THREE.Vector3;t.x=n.x-i*(e-1),t.y=0,t.z=n.z-s*(e-1);var o=t.distanceTo(new THREE.Vector3(0,0,0));t.multiplyScalar(1e3/(o||1)),r._camera.position.x=t.x,r._camera.position.y=300-a*(e-1),r._camera.position.z=t.z,r._camera.lookAt(r._scene3d.position)},duration:2e3,delta:"linear"}).start()}}}},{key:"exportModel",value:function(){var e=this._exporter.parse(this._scene3d);new Blob([e],{type:"text/plain;charset=utf-8"});console.log(e)}},{key:"showTooltip",value:function(e){if(e){var t=this._scene2d.getObjectByName("navigator-tooltip");t&&this._scene2d.remove(t);var r=this._scene3d.getObjectByName(e,!0),n=this._scene3d.getObjectByName(e+"-marker",!0);if(r&&n){var o=n.getWorldPosition().clone();o.project(this._camera),o.z=.5;var i={location:r.userData.location,material:r.userData.material,qty:r.userData.qty},a=(t=this.createTooltipForNavigator(i)).getWorldScale().clone(),s=a.x/this.model.width,c=a.y/this.model.height;a.normalize(),a.x=0,a.y=1.5*a.y*c,a.z=0,o.add(a),o.unproject(this._2dCamera),t.position.set(o.x,o.y,o.z),t.name="navigator-tooltip",t.scale.x=t.scale.x*s,t.scale.y=t.scale.y*c,this._scene2d.add(t),this.render_threed()}}}},{key:"transcoord2dTo3d",value:function(e){var t=this.model,r=t.width,n=t.height,o=e.x,i=void 0===o?0:o,a=e.y,s=void 0===a?0:a,c=e.z,l=void 0===c?0:c,u=r/2,h=n/2,f={};return f.x=i-u,f.y=s-h,f.z=l,f}},{key:"transcoord3d",value:function(e){var t=e.left,r=e.top,n=e.zPos,o=void 0===n?0:n,i=e.width,a=e.height,s=e.depth,c=void 0===s?0:s,l=JSON.parse(JSON.stringify(e));return l.width=i,l.height=c,l.depth=a,l.x=-(t-this.model.width/2+i/2),l.y=o+c/2,l.z=r-this.model.height/2+a/2,l}},{key:"_showWebglNoSupportText",value:function(e){e.save();var t=this.model,r=t.width,n=t.height;e.font=r/20+"px Arial",e.textAlign="center",e.fillText("WebGL no support",r/2-r/40,n/2),e.restore()}},{key:"_onDataChanged",value:function(){var e=this;if(this._data)if(this._data instanceof Array)this._data.forEach(function(t){var r=t;setTimeout(function(){var e=r.loc||r.LOC||r.location||r.LOCATION,t=this.getObject(e);t&&(t.userData=r,t.onUserDataChanged())}.bind(e))});else{for(var t in this._data)!function(){var r=t;e._data.hasOwnProperty(r)&&setTimeout(function(){var e=this._data[r],t=this.getObject(r);t&&(t.userData=e,t.onUserDataChanged())}.bind(e))}()}this._dataChanged=!1,this.render_threed()}},{key:"onchange",value:function(e,t){(e.hasOwnProperty("width")||e.hasOwnProperty("height")||e.hasOwnProperty("threed"))&&this.destroy_scene3d(),e.hasOwnProperty("autoRotate")&&(this._controls.autoRotate=e.autoRotate),(e.hasOwnProperty("fov")||e.hasOwnProperty("near")||e.hasOwnProperty("far")||e.hasOwnProperty("zoom"))&&(this._camera.near=this.model.near,this._camera.far=this.model.far,this._camera.zoom=.01*this.model.zoom,this._camera.fov=this.model.fov,this._camera.updateProjectionMatrix(),this._controls.cameraChanged=!0,this._controls.update()),e.hasOwnProperty("data")&&this._data!==e.data&&(this._data=e.data,this._dataChanged=!0),this.invalidate()}},{key:"onmousedown",value:function(e){this._controls&&this._controls.onMouseDown(e)}},{key:"onmousemove",value:function(e){if(this._controls){var t=this.transcoordC2S(e.offsetX,e.offsetY);this._mouse.x=(t.x-this.model.left)/this.model.width*2-1,this._mouse.y=-(t.y-this.model.top)/this.model.height*2+1;var r=this.getObjectByRaycast();console.log(r);var n=new THREE.BoxHelper(r,16776960);if(this._scene3d.add(n),r&&r.onmousemove)r.onmousemove(e,this);else{if(!this._scene2d)return;this._scene2d.remove(this._scene2d.getObjectByName("tooltip")),this.render_threed()}this._controls.onMouseMove(e),e.stopPropagation()}}},{key:"onmouseleave",value:function(e){if(this._scene2d){var t=this._scene2d.getObjectByName("tooltip");t&&this._scene2d.remove(t)}}},{key:"onwheel",value:function(e){this._controls&&(this.handleMouseWheel(e),e.stopPropagation())}},{key:"ondragstart",value:function(e){if(this._controls){var t=this.transcoordC2S(e.offsetX,e.offsetY);this._mouse.x=(t.x-this.model.left)/this.model.width*2-1,this._mouse.y=-(t.y-this.model.top)/this.model.height*2+1,this._controls.onDragStart(e),e.stopPropagation()}}},{key:"ondragmove",value:function(e){this._controls&&(this._controls.onDragMove(e),e.stopPropagation())}},{key:"ondragend",value:function(e){this._controls&&(this._controls.onDragEnd(e),e.stopPropagation())}},{key:"ontouchstart",value:function(e){this._controls&&(this._controls.onTouchStart(e),e.stopPropagation())}},{key:"ontouchmove",value:function(e){this._controls&&(this._controls.onTouchMove(e),e.stopPropagation())}},{key:"ontouchend",value:function(e){this._controls&&(this._controls.onTouchEnd(e),e.stopPropagation())}},{key:"onkeydown",value:function(e){this._controls&&(this._controls.onKeyDown(e),e.stopPropagation())}},{key:"handleMouseWheel",value:function(e){var t=this.model.zoom;(t+=.01*-e.deltaY)<0&&(t=0),this.set("zoom",t)}},{key:"scene3d",get:function(){return this._scene3d||this.init_scene3d(),this._scene3d}},{key:"layout",get:function(){return h.get("three")}},{key:"nature",get:function(){return f}}]),t}();t.default=d,l.register("visualizer",d)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={reflow:function(e,t){},capturables:function(e){return e.get("threed")?[]:e.components},drawables:function(e){return e.get("threed")?[]:e.components},isStuck:function(e){return!1}};scene.Layout.register("three",n),t.default=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e,t){function r(){return Math.pow(.95,l.zoomSpeed)}function n(e){p-=e}function o(e){d-=e}function i(e){l.object instanceof THREE.PerspectiveCamera?y/=e:l.object instanceof THREE.OrthographicCamera?(l.object.zoom=Math.max(l.minZoom,Math.min(l.maxZoom,l.object.zoom*e)),l.object.updateProjectionMatrix(),b=!0):(console.warn("WARNING: ThreeControls.js encountered an unknown camera type - dolly/zoom disabled."),l.enableZoom=!1)}function a(e){l.object instanceof THREE.PerspectiveCamera?y*=e:l.object instanceof THREE.OrthographicCamera?(l.object.zoom=Math.max(l.minZoom,Math.min(l.maxZoom,l.object.zoom/e)),l.object.updateProjectionMatrix(),b=!0):(console.warn("WARNING: ThreeControls.js encountered an unknown camera type - dolly/zoom disabled."),l.enableZoom=!1)}this.object=e,this.component=t,this.enabled=!0,this.target=new THREE.Vector3,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.25,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.keyPanSpeed=7,this.autoRotate=this.component.model.autoRotate||!1,this.autoRotateSpeed=2,this.enableKeys=!0,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40},this.mouseButtons={ORBIT:THREE.MOUSE.LEFT,ZOOM:THREE.MOUSE.MIDDLE,PAN:THREE.MOUSE.RIGHT},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.cameraChanged=!1,this.getPolarAngle=function(){return c},this.getAzimuthalAngle=function(){return s},this.reset=function(){l.target.copy(l.target0),l.object.position.copy(l.position0),l.object.zoom=l.zoom0,l.object.updateProjectionMatrix(),l.update(),h=u.NONE},this.update=function(){var t=new THREE.Vector3,r=(new THREE.Quaternion).setFromUnitVectors(e.up,new THREE.Vector3(0,1,0)),o=r.clone().inverse(),i=new THREE.Vector3,a=new THREE.Quaternion;return function(){var e=l.object.position;t.copy(e).sub(l.target),t.applyQuaternion(r),s=Math.atan2(t.x,t.z),c=Math.atan2(Math.sqrt(t.x*t.x+t.z*t.z),t.y),l.autoRotate&&h===u.NONE&&n(2*Math.PI/60/60*l.autoRotateSpeed),s+=p,c+=d,s=Math.max(l.minAzimuthAngle,Math.min(l.maxAzimuthAngle,s)),c=Math.max(l.minPolarAngle,Math.min(l.maxPolarAngle,c)),c=Math.max(f,Math.min(Math.PI-f,c));var b=t.length()*y;return b=Math.max(l.minDistance,Math.min(l.maxDistance,b)),l.target.add(m),t.x=b*Math.sin(c)*Math.sin(s),t.y=b*Math.cos(c),t.z=b*Math.sin(c)*Math.cos(s),t.applyQuaternion(o),e.copy(l.target).add(t),l.object.lookAt(l.target),!0===l.enableDamping?(p*=1-l.dampingFactor,d*=1-l.dampingFactor):(p=0,d=0),y=1,m.set(0,0,0),!!(l.cameraChanged||i.distanceToSquared(l.object.position)>f||8*(1-a.dot(l.object.quaternion))>f)&&(i.copy(l.object.position),a.copy(l.object.quaternion),l.cameraChanged=!1,l.component.render_threed(),!0)}}(),this.dispose=function(){},this.onMouseDown=function(e){},this.onMouseMove=function(e){},this.onMouseUp=function(e){},this.onDragStart=function(e){if(!1!==this.enabled&&!1!==this.enableRotate)switch(l.component.stop(),h=!0===e.altKey?u.PAN:u.ROTATE){case u.ROTATE:this.enableRotate&&function(e){v.set(e.offsetX,e.offsetY)}(e);break;case u.DOLLY:this.enableZoom&&function(e){O.set(e.offsetX,e.offsetY)}(e);break;case u.PAN:this.enablePan&&function(e){w.set(e.offsetX,e.offsetY)}(e)}},this.onDragMove=function(e){if(this.enabled)switch(h=!0===e.altKey?u.PAN:u.ROTATE){case u.ROTATE:this.enableRotate&&function(e){_.set(e.offsetX,e.offsetY),E.subVectors(_,v);var t=l.component;n(2*Math.PI*E.x/t.get("width")*l.rotateSpeed),o(2*Math.PI*E.y/t.get("height")*l.rotateSpeed),v.copy(_),l.update()}(e);break;case u.DOLLY:this.enableZoom&&function(e){R.set(e.offsetX,e.offsetY),k.subVectors(R,O),k.y>0?i(r()):k.y<0&&a(r()),O.copy(R),l.update()}(e);break;case u.PAN:this.enablePan&&function(e){g.set(e.offsetX,e.offsetY),T.subVectors(g,w),M(T.x,T.y),w.copy(g),l.update()}(e)}},this.onDragEnd=function(e){!1!==this.enabled&&!1!==this.enableRotate&&(h=u.NONE,l.component.threed_animate())},this.onKeyDown=function(e){!1!==this.enabled&&!1!==this.enableKeys&&!1!==this.enablePan&&function(e){switch(e.keyCode){case l.keys.UP:M(0,l.keyPanSpeed),l.update();break;case l.keys.BOTTOM:M(0,-l.keyPanSpeed),l.update();break;case l.keys.LEFT:M(l.keyPanSpeed,0),l.update();break;case l.keys.RIGHT:M(-l.keyPanSpeed,0),l.update()}}(e)},this.onTouchStart=function(e){},this.onTouchMove=function(e){},this.onTouchEnd=function(e){};var s,c,l=this,u={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_DOLLY:4,TOUCH_PAN:5},h=u.NONE,f=1e-6,d=0,p=0,y=1,m=new THREE.Vector3,b=!1,v=new THREE.Vector2,_=new THREE.Vector2,E=new THREE.Vector2,w=new THREE.Vector2,g=new THREE.Vector2,T=new THREE.Vector2,O=new THREE.Vector2,R=new THREE.Vector2,k=new THREE.Vector2,j=function(){var e=new THREE.Vector3;return function(t,r){var n=r.elements;e.set(n[0],n[1],n[2]),e.multiplyScalar(-t),m.add(e)}}(),P=function(){var e=new THREE.Vector3;return function(t,r){var n=r.elements;e.set(n[4],n[5],n[6]),e.multiplyScalar(t),m.add(e)}}(),M=function(){var e=new THREE.Vector3;return function(t,r){var n=l.component===document?l.component.body:l.component;if(l.object instanceof THREE.PerspectiveCamera){var o=l.object.position;e.copy(o).sub(l.target);var i=e.length();i*=Math.tan(l.object.fov/2*Math.PI/180),j(2*t*i/n.model.height,l.object.matrix),P(2*r*i/n.model.height,l.object.matrix)}else l.object instanceof THREE.OrthographicCamera?(j(t*(l.object.right-l.object.left)/n.model.width,l.object.matrix),P(r*(l.object.top-l.object.bottom)/n.model.height,l.object.matrix)):(console.warn("WARNING: ThreeControls.js encountered an unknown camera type - pan disabled."),l.enablePan=!1)}}();this.update()};(n.prototype={}).constructor=n,t.default=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=scene,i=o.RectPath,a=o.Component,s={mutable:!1,resizable:!0,rotatable:!0,properties:[{type:"string",label:"src",name:"src",property:"src"},{type:"checkbox",label:"autoplay",name:"autoplay",property:"autoplay"}]},c=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i(a)),n(t,[{key:"init_scene",value:function(e,t){var r=this.model,n=r.mute,o=r.loop,i=r.autoplay,a=r.src,s=r.fov,c=r.clickAndDrag,l=r.wheelEnabled;this._dragStart={},this._lon=0,this._lat=0,this._clickAndDrag=c,this._isPlaying=!1,this._wheelEnabled=l,this._fov=s||35,this._fovMin=3,this._fovMax=100,this._time=(new Date).getTime(),this._scene=new THREE.Scene,this._camera=new THREE.PerspectiveCamera(s,e/t,.1,1e3),this._camera.setFocalLength(s),this._renderer=new THREE.WebGLRenderer,this._renderer.setSize(e,t),this._renderer.autoClear=!1,this._renderer.setClearColor(3355443,1),this._video=document.createElement("video"),this._video.setAttribute("crossorigin","anonymous"),this._video.loop=o,this._video.muted=n,this._texture=new THREE.Texture(this._video);var u=this;this._video.addEventListener("ended",function(){this._isPlaying=!1}),this._video.addEventListener("progress",function(){var e=null;u._video&&u._video.buffered&&u._video.buffered.length>0&&u._video.buffered.end&&u._video.duration?e=u._video.buffered.end(0)/u._video.duration:u._video&&void 0!==u._video.bytesTotal&&u._video.bytesTotal>0&&void 0!==u._video.bufferedBytes&&(e=u._video.bufferedBytes/u._video.bytesTotal);Math.round(100*e)}),this._video.addEventListener("canplay",function(){!0===i&&(u.play(),u._videoReady=!0)}),this._video.src=this.app.url(a),this._texture.generateMipmaps=!1,this._texture.minFilter=THREE.LinearFilter,this._texture.magFilter=THREE.LinearFilter,this._texture.format=THREE.RGBFormat,this._mesh=new THREE.Mesh(new THREE.SphereGeometry(500,80,50),new THREE.MeshBasicMaterial({map:this._texture})),this._mesh.scale.x=-1,this._scene.add(this._mesh),this.animate()}},{key:"destroy_scene",value:function(){cancelAnimationFrame(this._requestAnimationId),this._requestAnimationId=void 0,this._texture.dispose(),this._scene.remove(this._mesh),this.unloadVideo(),this._renderer=void 0,this._camera=void 0,this._keyboard=void 0,this._controls=void 0,this._projector=void 0,this._load_manager=void 0,this._scene=void 0,this._video=void 0}},{key:"loadVideo",value:function(e){this._video.src=e}},{key:"unloadVideo",value:function(){this.pause(),this._video.src="",this._video.removeAttribute("src")}},{key:"play",value:function(){this._isPlaying=!0,this._video.play()}},{key:"pause",value:function(){this._isPlaying=!1,this._video.pause()}},{key:"resize",value:function(e,t){this._renderer&&(this._renderer.setSize(e,t),this._camera.aspect=e/t,this._camera.updateProjectionMatrix())}},{key:"animate",value:function(){if(this._requestAnimationId=requestAnimationFrame(this.animate.bind(this)),this._video.readyState===this._video.HAVE_ENOUGH_DATA&&void 0!==this._texture){var e=(new Date).getTime();e-this._time>=30&&(this._texture.needsUpdate=!0,this._time=e)}this.render(),this.invalidate()}},{key:"render",value:function(){this._lat=Math.max(-85,Math.min(85,this._lat||0)),this._phi=(90-this._lat)*Math.PI/180,this._theta=(this._lon||0)*Math.PI/180;var e=500*Math.sin(this._phi)*Math.cos(this._theta),t=500*Math.cos(this._phi),r=500*Math.sin(this._phi)*Math.sin(this._theta);this._camera.lookAt(new THREE.Vector3(e,t,r)),this.model.flatProjection?(this._camera.position.x=0,this._camera.position.y=0,this._camera.position.z=0):(this._camera.position.x=-e,this._camera.position.y=-t,this._camera.position.z=-r),this._renderer.clear(),this._renderer.render(this._scene,this._camera)}},{key:"createControls",value:function(){var e=this.options.muted?"fa-volume-off":"fa-volume-up",t='           <div class="controls">               <a href="#" class="playButton button fa '+(this.options.autoplay?"fa-pause":"fa-play")+'"></a>               <a href="#" class="muteButton button fa '+e+'"></a>               <a href="#" class="fullscreenButton button fa fa-expand"></a>           </div>       ';$(this.element).append(t,!0),this.options.hideControls&&$(this.element).find(".controls").hide()}},{key:"attachControlEvents",value:function(){var e=this;this.element.addEventListener("mousemove",this.onMouseMove.bind(this),!1),this.element.addEventListener("touchmove",this.onMouseMove.bind(this),!1),this.element.addEventListener("mousewheel",this.onMouseWheel.bind(this),!1),this.element.addEventListener("DOMMouseScroll",this.onMouseWheel.bind(this),!1),this.element.addEventListener("mousedown",this.onMouseDown.bind(this),!1),this.element.addEventListener("touchstart",this.onMouseDown.bind(this),!1),this.element.addEventListener("mouseup",this.onMouseUp.bind(this),!1),this.element.addEventListener("touchend",this.onMouseUp.bind(this),!1),$(document).on("webkitfullscreenchange mozfullscreenchange fullscreenchange",this.fullscreen.bind(this)),$(window).resize(function(){e.resizeGL($(e.element).width(),$(e.element).height())}),$(this.element).find(".playButton").click(function(t){t.preventDefault(),$(this).hasClass("fa-pause")?($(this).removeClass("fa-pause").addClass("fa-play"),e.pause()):($(this).removeClass("fa-play").addClass("fa-pause"),e.play())}),$(this.element).find(".fullscreenButton").click(function(t){t.preventDefault();var r=$(e.element)[0];$(this).hasClass("fa-expand")?r.requestFullscreen?r.requestFullscreen():r.msRequestFullscreen?r.msRequestFullscreen():r.mozRequestFullScreen?r.mozRequestFullScreen():r.webkitRequestFullscreen&&r.webkitRequestFullscreen():r.requestFullscreen?document.exitFullscreen():r.msRequestFullscreen?document.msExitFullscreen():r.mozRequestFullScreen?document.mozCancelFullScreen():r.webkitRequestFullscreen&&document.webkitExitFullscreen()}),$(this.element).find(".muteButton").click(function(t){t.preventDefault(),$(this).hasClass("fa-volume-off")?($(this).removeClass("fa-volume-off").addClass("fa-volume-up"),e._video.muted=!1):($(this).removeClass("fa-volume-up").addClass("fa-volume-off"),e._video.muted=!0)})}},{key:"_draw",value:function(e){var t=this.model,r=t.left,n=t.top,o=t.width,i=t.height;t.src;e.beginPath(),e.rect(r,n,o,i)}},{key:"_post_draw",value:function(e){var t=this.model,r=t.left,n=t.top,o=t.width,i=t.height;t.src?(this._scene||(this.init_scene(o,i),this.render()),e.drawImage(this._renderer.domElement,0,0,o,i,r,n,o,i)):this.drawFill(e),this.drawStroke(e)}},{key:"onchange",value:function(e,t){(e.hasOwnProperty("width")||e.hasOwnProperty("height"))&&this.resize(this.model.width,this.model.height),(e.hasOwnProperty("src")||e.hasOwnProperty("autoplay"))&&this.destroy_scene(),this.invalidate()}},{key:"ondblclick",value:function(e){this._isPlaying?this.pause():this.play(),e.stopPropagation()}},{key:"onmousedown",value:function(e){}},{key:"onmousemove",value:function(e){if(!1===this._clickAndDrag){var t,r;this._onPointerDownPointerX=e.offsetX,this._onPointerDownPointerY=-e.offsetY,this._onPointerDownLon=this._lon,this._onPointerDownLat=this._lat,t=e.offsetX-this._renderer.getContext().canvas.offsetLeft,r=e.offsetY-this._renderer.getContext().canvas.offsetTop,this._lon=t/this._renderer.getContext().canvas.width*430-225,this._lat=r/this._renderer.getContext().canvas.height*-180+90}}},{key:"onwheel",value:function(e){if(!1!==this._wheelEnabled){this._fov-=.01*e.deltaY,this._fov<this._fovMin?this._fov=this._fovMin:this._fov>this._fovMax&&(this._fov=this._fovMax),this._camera.setFocalLength(this._fov),this._camera.updateProjectionMatrix(),e.stopPropagation()}}},{key:"ondragstart",value:function(e){this._dragStart.x=e.offsetX,this._dragStart.y=e.offsetY}},{key:"ondragmove",value:function(e){if(!1!==this._isPlaying){if(!1!==this._clickAndDrag){this._onPointerDownPointerX=e.offsetX,this._onPointerDownPointerY=-e.offsetY,this._onPointerDownLon=this._lon,this._onPointerDownLat=this._lat;var t,r;t=e.offsetX-this._dragStart.x,r=e.offsetY-this._dragStart.y,this._dragStart.x=e.offsetX,this._dragStart.y=e.offsetY,this._lon+=t,this._lat-=r}e.stopPropagation()}}},{key:"ondragend",value:function(e){}},{key:"ontouchstart",value:function(e){}},{key:"ontouchmove",value:function(e){}},{key:"ontouchend",value:function(e){}},{key:"onkeydown",value:function(e){}},{key:"nature",get:function(){return s}}]),t}();t.default=c,a.register("video-player-360",c)},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=scene,c=s.Component,l=s.Rect,u=function(e){function t(e,r){n(this,t);var i=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return i._model=e,i.createObject(e,r),i}return i(t,THREE.Mesh),a(t,[{key:"createObject",value:function(e,t){var r=e.left+e.width/2-t.width/2,n=e.top+e.height/2-t.height/2,o=.5*e.depth,i=e.rotation;this.type=e.type,this.createDoor(e.width,e.height,e.depth),this.position.set(r,o,n),this.rotation.y=i||0}},{key:"createDoor",value:function(e,t,r){var n=this.model.fillStyle,o=void 0===n?"saddlebrown":n;this.geometry=new THREE.BoxGeometry(e,r,t),this.material=new THREE.MeshLambertMaterial({color:o,side:THREE.FrontSide})}},{key:"model",get:function(){return this._model}}]),t}();t.default=u;var h=t.Door2d=function(e){function t(){return n(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,l),a(t,[{key:"is3dish",value:function(){return!0}}]),t}();c.register("door",h),scene.Component3d.register("door",u)},function(e,t,r){"use strict";function n(){if(!n.done){n.done=!0;var e=new THREE.OBJLoader,t=new THREE.MTLLoader;e.setPath("./obj/Fork_lift/"),t.setPath("./obj/Fork_lift/"),t.load("ForkLift.mtl",function(t){t.preload(),e.setMaterials(t),t.side=THREE.frontSide,e.load("ForkLift.obj",function(e){o=e})})}}Object.defineProperty(t,"__esModule",{value:!0});var o,i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=function(e){function t(e,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return n._model=e,n.createObject(e,r),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,THREE.Object3D),i(t,[{key:"createObject",value:function(e,r){if(t.extObject){var n=e.cx-r.width/2,o=e.cy-r.height/2;e.depth,e.left,r.width,e.top,r.height,e.rotation;this.type="forklift",this.add(t.extObject.clone()),this.scale.set(10,10,10),this.position.set(n,0,o),this.rotation.y=e.rotation||0}else setTimeout(this.createObject.bind(this,e,r),50)}}],[{key:"extObject",get:function(){return o||n(),o}}]),t}();t.default=a,scene.Component3d.register("forklift",a)},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=["#6666ff","#ccccff","#ffcccc","#cc3300"],c={mutable:!1,resizable:!0,rotatable:!0,properties:[{type:"number",label:"z-pos",name:"zPos",property:"zPos"},{type:"string",label:"location",name:"location",property:"location"}]},l=function(e){function t(e,r,i){n(this,t);var a=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return a._model=e,a._container=i,a.userData.temperature=e.humidity?e.humidity[0]:0,a.userData.humidity=e.humidity?e.humidity[1]:0,a.createObject(e,r),a}return i(t,THREE.Object3D),a(t,[{key:"createObject",value:function(e,t){var r=e.cx-t.width/2,n=e.cy-t.height/2,o=(e.zPos||0)+e.depth/2;e.rotation;this.type="humidity-sensor",e.location&&(this.name=e.location);for(var i=0;i<3;i++){this.createSensor(e.rx*(1+.5*i),e.ry*(1+.5*i),e.depth*(1+.5*i),i).material.opacity=.5-.15*i}this.position.set(r,o,n),this.rotation.y=e.rotation||0,this._container._heatmap.addData({x:Math.floor(e.cx),y:Math.floor(e.cy),value:this.userData.temperature}),this._container.updateHeatmapTexture()}},{key:"createSensor",value:function(e,t,r,n){var o,i=0===n,a=new THREE.SphereGeometry(e,32,32);o=i?new THREE.MeshLambertMaterial({color:"#cc3300",side:THREE.FrontSide}):new THREE.MeshBasicMaterial({color:"#cc3300",side:THREE.FrontSide,wireframe:!0,wireframeLinewidth:1});var s=new THREE.Mesh(a,o);return s.material.transparent=!0,i?s.onmousemove=this.onmousemove:s.raycast=function(){},this.add(s),s}},{key:"onUserDataChanged",value:function(){(function e(t,r,n){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,r);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,r,n)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(n)})(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"onUserDataChanged",this).call(this);var e=this._model,r=e.cx,n=e.cy;r=Math.floor(r),n=Math.floor(n);var o=this.userData.temperature,i=!0,a=!1,c=void 0;try{for(var l,u=this.children[Symbol.iterator]();!(i=(l=u.next()).done);i=!0){var h=l.value,f=0;f=o<0?0:o<10?1:o<20?2:3,h.material.color.set(s[f])}}catch(e){a=!0,c=e}finally{try{!i&&u.return&&u.return()}finally{if(a)throw c}}var d=this._container._heatmap._store._data[r][n];this._container._heatmap.addData({x:r,y:n,value:o-d}),this._container._heatmap.repaint(),this._container.updateHeatmapTexture()}},{key:"onmousemove",value:function(e,t){var r=t.tooltip||t._scene2d.getObjectByName("tooltip");if(r&&(t._scene2d.remove(r),t.tooltip=null,t.render_threed()),this.parent.visible){this.parent.userData||(this.parent.userData={});var n="";for(var o in this.parent.userData)this.parent.userData[o]&&(n+=o+": "+this.parent.userData[o]+"\n");if(n.length>0){r=t.tooltip=t.makeTextSprite(n);var i=new THREE.Vector3,a=r.getWorldScale().clone(),s=a.x/t.model.width,c=a.y/t.model.height;i.set(t._mouse.x,t._mouse.y,.5),a.normalize(),a.x=a.x/2*s,a.y=-a.y/2*c,a.z=0,i.add(a),i.unproject(t._2dCamera),r.position.set(i.x,i.y,i.z),r.name="tooltip",r.scale.x=r.scale.x*s,r.scale.y=r.scale.y*c,t._scene2d.add(r),t._renderer&&t._renderer.render(t._scene2d,t._2dCamera),t.invalidate()}}}}]),t}();t.default=l;var u=scene,h=u.Component,f=u.Ellipse,d=t.Sensor=function(e){function t(){return n(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,f),a(t,[{key:"is3dish",value:function(){return!0}},{key:"_draw",value:function(e){var t=this.bounds,r=t.left,n=t.top,o=t.width,i=t.height;e.beginPath(),e.rect(r,n,o,i),this.model.fillStyle={type:"pattern",fitPattern:!0,image:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAABBCAYAAACTiffeAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyppVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTMyIDc5LjE1OTI4NCwgMjAxNi8wNC8xOS0xMzoxMzo0MCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTUuNSAoTWFjaW50b3NoKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpDQ0E1QkUzRTRDMDcxMUU2QkMyRDk3MzlGN0EzMTI2NSIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDpDQ0E1QkUzRjRDMDcxMUU2QkMyRDk3MzlGN0EzMTI2NSI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjJFQ0Q4QzE5NEI1MjExRTZCQzJEOTczOUY3QTMxMjY1IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjJFQ0Q4QzFBNEI1MjExRTZCQzJEOTczOUY3QTMxMjY1Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+tgU1kQAAB4pJREFUeNrcWktMVFcYPgPIVHxTERpsq4XaBwZbjRIjaUO0qbGuWDQQFnZhgkuty7qUhMQYTdqFGl10YcSYUBfWkEjCxtREClEDJkZgbAsWxYIIKjPCTP/v8p3xOtyZe+4dRtA/+XIv957H/53zv+4ZArFYTL0NEvBCJBAIzHhWsmZNllwWChYJ3iGCaC7IEWQLooJJXsNERPBc8LT33r0XbnO76WlEJJGAKA9F8wUrSGBBQpcsKm3vGCOmbM+m2GZC8ETwWDAuxKJeSaUkYifAlX9X8J5gqU1hRWWwuuO8QrEXVFQrm00EiTzuZA7bxEge/UYEQ0LouSkZRyIOBIqJXCqfxQkfCh4JRmXSSa92jblL164FoWXc3eUkFSXGBPdl7HE3Mq8QcSBQJFhjs3ms6KCgvycUGnHymXRE5sTurBIU0tc0IZjcgBB6loxMnEgCicVy+YwmpM3nH0FIBgtnOgJxp7BD7wuW2ILFABbS7kOORDjAh/LnOq4+SPwruOO0Gq+JUIHcrqUvgQD0uKv9ZwYR6QDFy+nMWQyPN6XDAw+mEaStL6Uz59peRxh2x+hTYx7GhW4lNHUdEEBm2IkIJv+Kk0P5dmkYcZkgi8Q/EqxmSI7aIlnUFoq1M0bp0GH6W4j2HzYgtFIuZbaxe8RX789wdiGzkop1ycCxFANitddzB/M4cMCWK5ATRhmGdd4IMucsseWdSZtD93HeRy5kMN9GjnEDQccx/KaKRDIIdqtC8CUH0spbfkRnfOiW0GScZbad/IC7ppPlPcGfMBsXPYJCYsw4j9g6l8rlW65qNlf7Jid9kmbI/VTwBU1zkrgh6JCxp3wnRDsZOto3gk1cOQx8TfDHbIZimQcTfkI/zeM8/wkuJS6U5xJFfAaK1wo+5iOYULMMPJSpkEuz+VqwgeaGcPubzDmYqnh0LRqFDDL7Hm7176alCE1mKTM0Vve5FxOU/kjIu+mHfwkuiE9E06p+hcxyUeKxy8QLGBoRUZBUC7iiAVtIjtCZewSdepVTjIn6rhI7IiQis/I9kiyayWQL6UNVgsVUPjF3BGylfNR2f1dwWQjdSeU7QsJVybQ+rGQShOEfWL3qRNfNaBais46zvNAhdx13bZUt5HYKmpyyvfFCe/3UBRlGmO8F3zEUI3q10odGDSMUfKCauQSLgLzxi/T/2ysJX0ToMyizG/lhhJX/WRS47zPkwixruCDYkUNiSo8z+s2eQAZJbBdXMeJlFR1M9HO5/IjQLiQu+y6V/YJFo+9xEsjkp6NLIN3jIP0ds3fvXjjzVlYAKChLbRWxog/0M/R2ofxAhXDmzJlRr/4wq6alRQhsZeLayWjkRRCtWlCGnD59+tqcEBECWPk6ljBFaVYmSIznBGeFUMdrISIE4Kn7BPWshxwlJydH1dTUqC1btlh/X79+XTU1NanJyZQVDvLPScEJIRTLGBEhgZLhoOCAW9u6ujpVVVX1yrMrV66o8+fPm0x1THBUyAyY6pblgQSct8GEBKSiosK6NjQ0qCNHjlj327ZtM50OczRwTiPJ8bATh1gFG0leXp51DYVCM55BZLXt4zsNsYfvfjLZmRxDnzjohYTh4pg0w5zD0vagm8+YmNY+U3PKkBygDv59hCG2Xs291FMX36ZVlyrEpiMGPmKXDdSlwzMRZuzaTC2xoY/YpVb6XEhWAaQyrd2zkLFnU4qok7mPsADcqeaf7KRuxqa11UcBmEkf0bKRurWYEtmU6aX14SN23VpMfWS9mr+y3ouzl85jIqVefGR1prXx6SNJdUtGJH8e+0h+WmX8fJdkRIbTGbS8vNy69vX1xZ/pe/0uDRn2QqTfzwwFBQWqtrZW1ddP15m3b9+Ov9P3eIc2aOtT+r0Q6fFDorq6Wm3fvl0Fg0HrG/3ixYvx97jHM7xDG7T1SabHC5Eur6Pv2LFDbd68WU1MTKjGxkZ16tSpGW3wDO/QBm3Rx4d0eSHS4dUnKisrrfvjx4+rnp7kG4p3aANBHx8+0+GFCErlTtORy8rK4uakSayIxVR1JKwOP3tqAfcreGKDNtrM0NeDdFI3MyKSrEad6plkUlJSYl3b2triz6peRNSucEQVTUUt4B7PtOi2uq+htFA3T3nkkpo+AXSVwsJC6zow8PKwY6PDQZz9mW6r+xrIIHXy9s3OL7Fz8yjnnUt1PuyW2c+q6WPMlPLgwfT/3RQXF7805pyZ1Y/9mW6r+7rITeri7xSFB8on3Wbp7e2d9gvbEWnbglx1OZirBrOzLOAez+I+xLa6r4ucdDvcNqm1Tqjps9ik0t3drcLhsHVgXVo6XWWPBAKqOTeoDuUtsoD7Ef5ShTZoiz7o6yLHqINKiwhP+I4Kfk3W5tatW+rq1avW/f79++NkHD8m5B3aQNAHfVMI5jxqcjJvfBrPA+Wk57+6REHGhiBPIMTq6ASfgDnpnxna29tVc3OzGhoaSkXisJAwKpdm9WcFkEHZgYyNZOckMCfsRGtrayoSnn9WyMgPPSg7kLGR7HSeQHSCY8MnUpjT6/mhJ4HQm/3TmwOhN/vHUAdCvn6eTlY7zRmRuZa3hsj/AgwA2qER3p3SY8gAAAAASUVORK5CYII="},this.drawFill(e)}},{key:"nature",get:function(){return c}}]),t}();h.register("humidity-sensor",d),scene.Component3d.register("humidity-sensor",l)},function(e,t,r){"use strict";function n(){if(!n.done){n.done=!0;var e=new THREE.TGALoader;THREE.Loader.Handlers.add(/\.tga$/i,e);var t=new THREE.OBJLoader,r=new THREE.MTLLoader;t.setPath("./obj/Casual_Man_02/"),r.setPath("./obj/Casual_Man_02/"),r.load("Casual_Man.mtl",function(e){e.preload(),t.setMaterials(e),e.side=THREE.frontSide,t.load("Casual_Man.obj",function(e){o=e})})}}Object.defineProperty(t,"__esModule",{value:!0});var o,i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=function(e){function t(e,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var o=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return o._model=e,o._threeContainer=n,o.createObject(e,r),o}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,THREE.Object3D),i(t,[{key:"createObject",value:function(e,r){if(t.extObject){var n=e.left+e.width/2-r.width/2,o=e.top+e.height/2-r.height/2;e.depth,e.left,r.width,e.top,r.height,e.rotation;this.type="person";var i=t.extObject.clone();this.add(i),i.scale.set(150,150,150),this.position.set(n,0,o),this.rotation.y=e.rotation||0,this._threeContainer.render_threed()}else setTimeout(this.createObject.bind(this,e,r),50)}}],[{key:"extObject",get:function(){return o||n(),o}}]),t}();t.default=a,scene.Component3d.register("person",a)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=(scene.Component,function(e){function t(e,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return n._model=e,n.createObject(e,r),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,THREE.Mesh),n(t,[{key:"createObject",value:function(e,t){this.createPlane(e.width,e.height,e.fillStyle);var r=e.left+e.width/2-t.width/2,n=e.top+e.height/2-t.height/2;this.position.x=r,this.position.z=n}},{key:"createPlane",value:function(e,t,r){if(this.geometry=new THREE.PlaneGeometry(e,t),r&&"pattern"==r.type&&r.image){var n=(new THREE.TextureLoader).load(r.image);n.wrapS=THREE.RepeatWrapping,n.wrapT=THREE.RepeatWrapping,n.repeat.set(1,1),this.material=new THREE.MeshBasicMaterial({map:n,side:THREE.FrontSide})}else this.material=new THREE.MeshBasicMaterial({color:r||"#ccaa76",side:THREE.FrontSide});this.rotation.x=-Math.PI/2,this.type="rect"}}]),t}());t.default=o,scene.Component3d.register("rect",o)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=function(e){return e&&e.__esModule?e:{default:e}}(r(0)),i=function(e){function t(e,r,n,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var i=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return i._model=e,i._threeContainer=n,i.createObject(e,r),i}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,THREE.Object3D),n(t,[{key:"createObject",value:function(e,t){var r=e.left+e.width/2-t.width/2,n=e.top+e.height/2-t.height/2,i=.5*e.depth*e.shelves,a=e.rotation;this.type=e.type;var s=this.createRackFrame(e.width,e.height,e.depth*e.shelves);this.add(s);for(var c=e.shelfPattern,l=0;l<e.shelves;l++){var u=-e.depth*e.shelves*.5;if(l>0){var h=this.createRackBoard(e.width,e.height);h.position.set(0,u+e.depth*l,0),h.rotation.x=Math.PI/2,h.material.opacity=.5,h.material.transparent=!0,this.add(h)}var f=new o.default({width:.7*e.width,height:.7*e.height,depth:.7*e.depth,fillStyle:e.fillStyle}),d=.7*e.depth;f.position.set(0,u+e.depth*l+.5*d,0),f.name=this.makeLocationString(this.makeShelfString(c,l+1,e.shelves)),this.add(f),this._threeContainer.putObject(f.name,f)}this.position.set(r,i,n),this.rotation.y=a||0}},{key:"createRackFrame",value:function(e,r,n){for(var o=Math.round(Math.min(e,r)/10),i=new THREE.Group,a=0;a<4;a++){var s=new THREE.BoxBufferGeometry(o,n,o),c=t.frameMaterial,l=new THREE.Mesh(s,c);switch(a){case 0:l.position.set(e/2,0,r/2);break;case 1:l.position.set(e/2,0,-r/2);break;case 2:l.position.set(-e/2,0,r/2);break;case 3:l.position.set(-e/2,0,-r/2)}i.add(l)}return i}},{key:"createRackBoard",value:function(e,r){var n=t.boardMaterial,o=new THREE.PlaneBufferGeometry(e,r,1,1);return new THREE.Mesh(o,n)}},{key:"cube",value:function(e){var t=.5*e.width,r=.5*e.height,n=.5*e.depth,o=new THREE.Geometry;return o.vertices.push(new THREE.Vector3(-t,-r,-n),new THREE.Vector3(-t,r,-n),new THREE.Vector3(-t,r,-n),new THREE.Vector3(t,r,-n),new THREE.Vector3(t,r,-n),new THREE.Vector3(t,-r,-n),new THREE.Vector3(t,-r,-n),new THREE.Vector3(-t,-r,-n),new THREE.Vector3(-t,-r,n),new THREE.Vector3(-t,r,n),new THREE.Vector3(-t,r,n),new THREE.Vector3(t,r,n),new THREE.Vector3(t,r,n),new THREE.Vector3(t,-r,n),new THREE.Vector3(t,-r,n),new THREE.Vector3(-t,-r,n),new THREE.Vector3(-t,-r,-n),new THREE.Vector3(-t,-r,n),new THREE.Vector3(-t,r,-n),new THREE.Vector3(-t,r,n),new THREE.Vector3(t,r,-n),new THREE.Vector3(t,r,n),new THREE.Vector3(t,-r,-n),new THREE.Vector3(t,-r,n)),o}},{key:"makeLocationString",value:function(e){var t=this._model,r=t.locPattern,n=void 0===r?"{z}{s}-{u}-{sh}":r,o=t.zone,i=void 0===o?"":o,a=t.section,s=void 0===a?"":a,c=t.unit,l=void 0===c?"":c,u=n;return u=u.replace(/{z}/i,i),u=u.replace(/{s}/i,s),u=u.replace(/{u}/i,l),u=u.replace(/{sh}/i,e)}},{key:"makeShelfString",value:function(e,t,r){if(e&&t&&r){var n=/^\-/.test(e),o=((e=e.replace(/#+/,"#")).match(/0/g)||[]).length||0,i=String(n?r-t+1:t);if(i.length>o&&o>0)i=i.split("").shift(i.length-o).join("");else{for(var a="",s=0;s<o-i.length;s++)a+="0";i=a+i}return i}}},{key:"raycast",value:function(e,t){}},{key:"onchange",value:function(e,t){e.hasOwnProperty("data")&&(this.data=e.data)}}],[{key:"boardMaterial",get:function(){return t._boardMaterial||(t._boardMaterial=new THREE.MeshBasicMaterial({color:"#dedede",side:THREE.DoubleSide})),t._boardMaterial}},{key:"frameMaterial",get:function(){return t._frameMaterial||(t._frameMaterial=new THREE.MeshLambertMaterial({color:13421772})),t._frameMaterial}}]),t}();t.default=i,scene.Component3d.register("rack",i)},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=scene,c=s.Component,l=s.Rect,u={mutable:!1,resizable:!0,rotatable:!0,properties:[{type:"number",label:"depth",name:"depth",property:"depth"}]},h=function(e){function t(e,r){n(this,t);var i=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return i._model=e,i.createObject(e,r),i}return i(t,THREE.Mesh),a(t,[{key:"createObject",value:function(e,t){var r=e.left+e.width/2-t.width/2,n=e.top+e.height/2-t.height/2,o=.5*e.depth,i=e.rotation;this.type=e.type,this.createWall(e.width,e.height,e.depth),this.position.set(r,o,n),this.rotation.y=i||0,e.alpha=e.alpha||.7,this.material.opacity=e.alpha,this.material.transparent=e.alpha<1}},{key:"createWall",value:function(e,t,r){var n=this._model.fillStyle,o=void 0===n?"gray":n;this.geometry=new THREE.BoxGeometry(e,r,t),this.material=new THREE.MeshLambertMaterial({color:o,side:THREE.FrontSide})}},{key:"model",get:function(){return this._model}}]),t}();t.default=h;var f=t.Wall2d=function(e){function t(){return n(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,l),a(t,[{key:"is3dish",value:function(){return!0}},{key:"nature",get:function(){return u}},{key:"controls",get:function(){}}]),t}();c.register("wall",f),scene.Component3d.register("wall",h)},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=scene,c=s.Component,l=s.Rect,u={mutable:!1,resizable:!0,rotatable:!0,properties:[{type:"number",label:"depth",name:"depth",property:"depth"},{type:"checkbox",label:"show-axis",name:"showAxis",property:"showAxis"}]},h=function(e){function t(e,r,i){n(this,t);var a=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));if(a._model=e,a._threeContainer=i,a.createObject(e,r),a.updateMatrixWorld(),e.showAxis){var s=new THREE.AxisHelper(100);a.add(s)}return a}return i(t,THREE.Mesh),a(t,[{key:"createObject",value:function(e,t){var r=e.left+e.width/2-t.width/2,n=e.top+e.height/2-t.height/2,o=e.zPos||.5*e.depth,i=e.rotation;this.type=e.type,this.createCube(e.width,e.height,e.depth),this.position.set(r,o,n),this.rotation.y=i||0}},{key:"createCube",value:function(e,t,r){var n=this.model.fillStyle,o=void 0===n?"lightgray":n;this.geometry=new THREE.BoxGeometry(e,r,t),this.material=new THREE.MeshLambertMaterial({color:o,side:THREE.FrontSide})}},{key:"model",get:function(){return this._model}},{key:"mixer",get:function(){return this._mixer||(this._mixer=new THREE.AnimationMixer(this),this._threeContainer.mixers.push(this._mixer)),this._mixer}}]),t}();t.default=h;var f=t.Cube2d=function(e){function t(){return n(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,l),a(t,[{key:"is3dish",value:function(){return!0}},{key:"controls",get:function(){}},{key:"nature",get:function(){return u}}]),t}();c.register("cube",f),scene.Component3d.register("cube",h)},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=scene,c=s.Component,l=s.Ellipse,u={mutable:!1,resizable:!0,rotatable:!0,properties:[{type:"number",label:"depth",name:"rz",property:"rz"}]},h=function(e){function t(e,r){n(this,t);var i=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return i._model=e,i.createObject(e,r),i}return i(t,THREE.Mesh),a(t,[{key:"createObject",value:function(e,t){var r=e.cx-t.width/2,n=e.cy-t.height/2,o=this.model.rz/2,i=e.rotation;this.type=e.type,this.createCylinder(this.model.rx,this.model.rz),this.position.set(r,o,n),this.rotation.y=i||0}},{key:"createCylinder",value:function(e,t){var r=this.model.fillStyle,n=void 0===r?"lightgray":r;this.geometry=new THREE.CylinderGeometry(e,e,t,25),this.material=new THREE.MeshLambertMaterial({color:n,side:THREE.FrontSide})}},{key:"model",get:function(){return this._model}}]),t}();t.default=h;var f=t.Cylinder2d=function(e){function t(){return n(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,l),a(t,[{key:"is3dish",value:function(){return!0}},{key:"controls",get:function(){}},{key:"nature",get:function(){return u}}]),t}();c.register("cylinder",f),scene.Component3d.register("cylinder",h)},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=scene,c=s.Component,l=s.Ellipse,u={mutable:!1,resizable:!0,rotatable:!0,properties:[{type:"number",label:"depth",name:"rz",property:"rz"}]},h=function(e){function t(e,r,i){n(this,t);var a=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return a._model=e,a._threeContainer=i,a.createObject(e,r),a}return i(t,THREE.Mesh),a(t,[{key:"createObject",value:function(e,t){var r=e.cx-t.width/2,n=e.cy-t.height/2,o=this.model.rx,i=e.rotation;this.type=e.type,this.createSphere(this.model.rx,this.model.rz),this.position.set(r,o,n),this.rotation.y=i||0}},{key:"createSphere",value:function(e,t){var r=this.model.fillStyle,n=void 0===r?"lightgray":r;this.geometry=new THREE.SphereGeometry(e,20,20),this.material=new THREE.MeshLambertMaterial({color:n,side:THREE.FrontSide})}},{key:"model",get:function(){return this._model}}]),t}();t.default=h;var f=t.Sphere2d=function(e){function t(){return n(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,l),a(t,[{key:"is3dish",value:function(){return!0}},{key:"controls",get:function(){}},{key:"nature",get:function(){return u}}]),t}();c.register("sphere",f),scene.Component3d.register("sphere",h)},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=scene,c=s.Component,l=s.Ellipse,u={mutable:!1,resizable:!0,rotatable:!0,properties:[{type:"number",label:"depth",name:"rz",property:"rz"}]},h=function(e){function t(e,r){n(this,t);var i=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return i._model=e,i.createObject(e,r),i}return i(t,THREE.Mesh),a(t,[{key:"createObject",value:function(e,t){var r=e.cx-t.width/2,n=e.cy-t.height/2,o=this.model.rx,i=e.rotation;this.type=e.type,this.createCone(this.model.rx,this.model.rz),this.position.set(r,o,n),this.rotation.y=i||0}},{key:"createCone",value:function(e,t){var r=this.model.fillStyle,n=void 0===r?"lightgray":r;this.geometry=new THREE.ConeGeometry(e,t,20),this.material=new THREE.MeshLambertMaterial({color:n,side:THREE.FrontSide})}},{key:"setEuler",value:function(e){var t=e.yaw,r=e.pitch,n=e.roll;this.setRotationFromEuler(new THREE.Vector3(n,r,t))}},{key:"setQuaternion",value:function(e){var t=e.x,r=e.y,n=e.z,o=e.w;this.setRotationFromQuaternion(new THREE.Quaternion(t,r,n,o))}},{key:"model",get:function(){return this._model}}]),t}();t.default=h;var f=t.Cone2d=function(e){function t(){return n(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,l),a(t,[{key:"is3dish",value:function(){return!0}},{key:"controls",get:function(){}},{key:"nature",get:function(){return u}}]),t}();c.register("cone",f),scene.Component3d.register("cone",h)},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=scene,c=s.Component,l=s.ImageView,u=s.Component3d,h={mutable:!1,resizable:!0,rotatable:!0,properties:[{type:"number",label:"z-pos",name:"zPos",property:"zPos"},{type:"number",label:"depth",name:"depth",property:"depth"},{type:"number",label:"rotation",name:"rotation",property:"rotation"},{type:"color",label:"box-color",name:"boxColor",property:"boxColor"}]},f=function(e){function t(e,r,i){n(this,t);var a=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return a._model=e,a._threeContainer=i,a.createObject(e,r),a}return i(t,THREE.Object3D),a(t,[{key:"createObject",value:function(e,t){var r=e.left,n=void 0===r?0:r,o=e.top,i=void 0===o?0:o,a=e.zPos,s=void 0===a?0:a,c=e.width,l=void 0===c?1:c,u=e.height,h=void 0===u?1:u,f=e.depth,d=void 0===f?1:f,p=n+l/2-t.width/2,y=i+h/2-t.height/2,m=s+.5*d,b=e.rotation;this.add(this.createCube(l,h,d));var v=this.createTextureBoard(l,d);this.add(v),v.position.set(0,0,.5*h),this.type=e.type,this.position.set(p,m,y),this.rotation.y=-b||0}},{key:"createCube",value:function(e,t,r){var n=this._model.boxColor,o=void 0===n?"#ccaa76":n,i=new THREE.BoxGeometry(e,r,t),a=new THREE.MeshLambertMaterial({color:o,side:THREE.FrontSide});return new THREE.Mesh(i,a)}},{key:"createTextureBoard",value:function(e,t){var r,n=this,o=this._model.fillStyle,i=void 0===o?"#ccaa76":o;if(i&&"pattern"==i.type&&i.image){var a=this._threeContainer._textureLoader.load(this._threeContainer.app.url(i.image),function(){n._threeContainer.render_threed()});a.repeat.set(1,1),a.minFilter=THREE.LinearFilter,r=new THREE.MeshBasicMaterial({map:a,side:THREE.FrontSide})}else r=new THREE.MeshLambertMaterial({color:i||"#ccaa76",side:THREE.FrontSide});var s=new THREE.PlaneGeometry(e,t,1,1);return new THREE.Mesh(s,r)}},{key:"raycast",value:function(e,t){}}]),t}();t.default=f;var d=t.Banner2d=function(e){function t(){return n(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,l),a(t,[{key:"is3dish",value:function(){return!0}},{key:"nature",get:function(){return h}}]),t}();c.register("banner",d),u.register("banner",f)},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=scene,c=s.Component,l=s.Rect,u={mutable:!1,resizable:!0,rotatable:!0,properties:[{type:"number",label:"depth",name:"depth",property:"depth"},{type:"color",label:"leg-color",name:"legColor",property:"legColor"}]},h=function(e){function t(e,r,i,a){n(this,t);var s=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return s._model=e,s._threeContainer=i,s.createObject(e,r),s}return i(t,THREE.Object3D),a(t,[{key:"createObject",value:function(e,t){var r=e.left+e.width/2-t.width/2,n=e.top+e.height/2-t.height/2,o=.5*e.depth,i=e.rotation;this.type=e.type;var a=this.createDeskLegs(e.width,e.height,e.depth);this.add(a);var s=e.depth/2-this.boardThickness,c=this.createDeskBoard(e.width,e.height);c.position.set(0,s,0),c.rotation.x=Math.PI/2,this.add(c),this.position.set(r,o,n),this.rotation.y=i||0}},{key:"createDeskLegs",value:function(e,t,r){var n=this.legThickness,o=this.margin;r-=n;for(var i=new THREE.Group,a=e/2-n/2-o,s=t/2-n/2-o,c=-n,l=0;l<4;l++){var u=new THREE.BoxGeometry(n,r,n),h=new THREE.MeshBasicMaterial({color:this._model.legColor||"#252525"}),f=new THREE.Mesh(u,h);switch(l){case 0:f.position.set(a,c,s);break;case 1:f.position.set(a,c,-s);break;case 2:f.position.set(-a,c,s);break;case 3:f.position.set(-a,c,-s)}i.add(f)}return i}},{key:"createDeskBoard",value:function(e,t){var r=new THREE.MeshBasicMaterial({color:this._model.fillStyle||"#ccaa76"}),n=new THREE.BoxGeometry(e,t,10,1,1);return new THREE.Mesh(n,r)}},{key:"cube",value:function(e){var t=.5*e.width,r=.5*e.height,n=.5*e.depth,o=new THREE.Geometry;return o.vertices.push(new THREE.Vector3(-t,-r,-n),new THREE.Vector3(-t,r,-n),new THREE.Vector3(-t,r,-n),new THREE.Vector3(t,r,-n),new THREE.Vector3(t,r,-n),new THREE.Vector3(t,-r,-n),new THREE.Vector3(t,-r,-n),new THREE.Vector3(-t,-r,-n),new THREE.Vector3(-t,-r,n),new THREE.Vector3(-t,r,n),new THREE.Vector3(-t,r,n),new THREE.Vector3(t,r,n),new THREE.Vector3(t,r,n),new THREE.Vector3(t,-r,n),new THREE.Vector3(t,-r,n),new THREE.Vector3(-t,-r,n),new THREE.Vector3(-t,-r,-n),new THREE.Vector3(-t,-r,n),new THREE.Vector3(-t,r,-n),new THREE.Vector3(-t,r,n),new THREE.Vector3(t,r,-n),new THREE.Vector3(t,r,n),new THREE.Vector3(t,-r,-n),new THREE.Vector3(t,-r,n)),o}},{key:"raycast",value:function(e,t){}},{key:"onchange",value:function(e,t){e.hasOwnProperty("data")&&(this.data=e.data)}},{key:"boardThickness",get:function(){var e=this._model.depth;return Math.min(10,e/10)}},{key:"legThickness",get:function(){var e=this._model,t=e.width,r=e.height,n=Math.min(t,r);return Math.min(10,n/10)}},{key:"margin",get:function(){return Math.min(this.legThickness/5,2)}}]),t}();t.default=h;var f=t.Desk2d=function(e){function t(){return n(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,l),a(t,[{key:"is3dish",value:function(){return!0}},{key:"controls",get:function(){}},{key:"nature",get:function(){return u}}]),t}();c.register("desk",f),scene.Component3d.register("desk",h)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=scene.Component3d,i=function(e){function t(e,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var o=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return o._model=e,o._threeContainer=n,o.createObject(e,r),o}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,THREE.Object3D),n(t,[{key:"createObject",value:function(e,t){var r=Math.min(e.width,e.height),n=e.left-t.width/2,o=e.top-t.height/2,i=(e.zPos||0)+r/2,a=e.rotation;this.type="beacon",e.location&&(this.name=e.location);for(var s=0;s<3;s++){this.createSensor(r*(1+.5*s)/2,s).material.opacity=.5-.15*s}this.position.set(n,i,o),this.rotation.y=a||0}},{key:"createSensor",value:function(e,t){var r,n=0===t,o=new THREE.SphereGeometry(e,32,32);r=n?new THREE.MeshLambertMaterial({color:"#57a1d6",side:THREE.FrontSide}):new THREE.MeshBasicMaterial({color:"#57a1d6",side:THREE.FrontSide,wireframe:!0,wireframeLinewidth:1});var i=new THREE.Mesh(o,r);return i.material.transparent=!0,this.add(i),i}}]),t}();t.default=i,o.register("beacon",i)}]);